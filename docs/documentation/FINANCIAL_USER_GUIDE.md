# 💰 Οδηγός Χρήστη - Οικονομική Διαχείριση

## 📋 Επισκόπηση

Η οικονομική διαχείριση του New Concierge περιλαμβάνει πλήρες σύστημα για τη διαχείριση των οικονομικών κτιρίου:
- 📊 Δαπάνες και έσοδα
- 💳 Εισπράξεις και πληρωμές
- 🧮 Υπολογισμός κοινοχρήστων
- 📈 Reports και analytics
- 💰 Διαχείριση αποθεματικού

---

## 🚀 Τελευταίες Ενημερώσεις (August 8, 2025)

### ✅ **Νέες Βελτιώσεις - Εισπράξεις & Πληρωμές**

#### 1. **Βελτιωμένη Λίστα Εισπράξεων** - NEW
- ✅ **Συγκεντρωτική προβολή**: Μία εγγραφή ανά ενοίκο αντί για μεμονωμένες πληρωμές
- ✅ **Προοδευτικά υπόλοιπα**: Ακριβής υπολογισμός βάσει ιστορικού συναλλαγών
- ✅ **Τρέχον υπόλοιπο**: Δυναμικός υπολογισμός από transaction history
- ✅ **Μηνιαία οφειλή**: Αυτόματη σύνδεση με κοινόχρηστα
- ✅ **Καθαρή εμφάνιση**: Αφαίρεση περιττών ετικετών

#### 2. **Καρτέλα Ενοίκου Modal** - NEW
- ✅ **Αναλυτικό ιστορικό**: Πλήρες transaction history ανά διαμέρισμα
- ✅ **Λειτουργική εκτύπωση**: Print-optimized καρτέλα για τους ενοίκους
- ✅ **Διαφορετικά δεδομένα**: Μοναδικό ιστορικό για κάθε διαμέρισμα
- ✅ **Error handling**: Graceful fallbacks και loading states

#### 3. **Backend API Βελτιώσεις** - ENHANCED
- ✅ **Dynamic balance calculation**: Real-time υπολογισμός υπολοίπων
- ✅ **Transaction history endpoint**: Νέο API για ιστορικό συναλλαγών
- ✅ **Enhanced serializers**: Εμπλουτισμένα δεδομένα με owner/tenant info

---

## 🚀 Προηγούμενες Ενημερώσεις (December 5, 2024)

### ✅ **Επιλύθηκαν Προβλήματα**

#### 1. **Building Selector** - FIXED
- ✅ Σωστή λειτουργία με multi-building management
- ✅ Type consistency μεταξύ components
- ✅ Smooth switching μεταξύ κτιρίων

#### 2. **CommonExpenseModal** - ENHANCED
- ✅ Μικρότερο ύψος (85% αντί για 95%)
- ✅ Μεγαλύτερο πλάτος (95% της οθόνης)
- ✅ 3-Column layout για καλύτερη οργάνωση
- ✅ Κουμπί "Αποθήκευση" με API integration
- ✅ JSON format για ελάχιστη επιβάρυνση πόρων

#### 3. **Common Expenses Calculator** - FIXED
- ✅ Δαπάνες εμφανίζονται σωστά στον υπολογισμό
- ✅ Χιλιοστά συμμετοχής λειτουργούν σωστά
- ✅ Πλήρης λειτουργικότητα υπολογισμού

---

## 💰 Διαχείριση Εισπράξεων (NEW)

### Βελτιωμένη Λίστα Εισπράξεων

#### Συγκεντρωτική Προβολή
Η νέα λίστα εμφανίζει **μία εγγραφή ανά ενοίκο** αντί για μεμονωμένες πληρωμές:

```
Ενοίκος - C2: 565€ (Μιχάλης Αντωνίου) - 2 πληρωμές → 318,75€
Ενοίκος - C3: 222€ (Δημήτρης Κωνσταντίνου) - 1 πληρωμή → 45,60€
```

#### Στήλες Πληροφοριών
1. **Συνολικό Ποσό**: Άθροισμα όλων των πληρωμών ενοίκου
2. **Ημερομηνία**: Ημερομηνία πρώτης πληρωμής
3. **Όνομα Ενοίκου**: Owner ή tenant name
4. **Μηνιαία Οφειλή**: Αυτόματος υπολογισμός από κοινόχρηστα
5. **Τρέχον Υπόλοιπο**: Προοδευτικό υπόλοιπο με color coding
   - 🔴 **Κόκκινο**: Οφειλή (αρνητικό υπόλοιπο)
   - 🟢 **Πράσινο**: Πίστωση (θετικό υπόλοιπο)
   - ⚫ **Γκρι**: Μηδενικό υπόλοιπο

### Καρτέλα Ενοίκου Modal

#### Άνοιγμα Καρτέλας
- Κάντε κλικ στο κουμπί **"Καρτέλα"** δίπλα από κάθε ενοίκο
- Ανοίγει modal με αναλυτικό ιστορικό συναλλαγών

#### Περιεχόμενο Καρτέλας
```
Καρτέλα Ενοίκου - [Όνομα]
Διαμέρισμα [Αριθμός] • Ιστορικό Συναλλαγών

📋 Στοιχεία:
- Διαμέρισμα: C2
- Μηνιαία Οφειλή: 246,25€
- Τρέχον Υπόλοιπο: 318,75€

📊 Ιστορικό Συναλλαγών:
- Κοινόχρηστα Αυγούστου 2025 → -246,25€ (Υπόλοιπο: -246,25€)
- Είσπραξη - Μετρητά → +222,00€ (Υπόλοιπο: -24,25€)
- Είσπραξη - Μετρητά → +343,00€ (Υπόλοιπο: +318,75€)
```

#### Εκτύπωση Καρτέλας
1. **Κουμπί Εκτύπωσης**: Πάνω δεξιά και κάτω αριστερά
2. **Optimized Layout**: Ειδικό CSS για εκτύπωση
3. **Error Handling**: Αυτόματη διαχείριση pop-up blockers
4. **Loading State**: Spinner κατά την προετοιμασία εκτύπωσης

#### Χρήση Εκτύπωσης
```
1. Κλικ στο "Εκτύπωση" κουμπί
2. Εμφάνιση loading animation
3. Άνοιγμα print dialog
4. Επιλογή εκτυπωτή και ρυθμίσεων
5. Εκτύπωση όμορφα μορφοποιημένου εγγράφου
```

### Φίλτρα και Αναζήτηση
- **Αναζήτηση**: Δυνατότητα αναζήτησης ανά όνομα ή διαμέρισμα
- **Τρόπος Πληρωμής**: Φιλτράρισμα ανά μέθοδο (Μετρητά, Τράπεζα, κλπ)
- **Ημερομηνίες**: Φιλτράρισμα ανά χρονικό διάστημα

---

## 💳 Διαχείριση Δαπανών

### Δημιουργία Νέας Δαπάνης

1. **Πρόσβαση**: Μεταβείτε στην καρτέλα "Δαπάνες"
2. **Επιλογή**: Κάντε κλικ στο "Νέα Δαπάνη"
3. **Συμπλήρωση**:
   - **Τίτλος Δαπάνης**: Περιγραφικό όνομα
   - **Ποσό**: Το ποσό σε ευρώ
   - **Ημερομηνία**: Ημερομηνία της δαπάνης
   - **Κατηγορία**: Επιλέξτε κατηγορία
   - **Τρόπος Κατανομής**: Πώς θα κατανεμηθεί
   - **Σημειώσεις**: Προαιρετικές σημειώσεις
   - **Επισύναψη**: Προαιρετικό αρχείο

4. **Αποθήκευση**: Κάντε κλικ στο "Αποθήκευση"

### Κατηγορίες Δαπανών

#### 🔧 Συντήρηση & Επισκευές
- Καθαρισμός Κοινοχρήστων Χώρων
- Συντήρηση Ανελκυστήρα
- Επισκευή Ηλεκτρικών
- Συντήρηση Υδραυλικών
- Συντήρηση Κτιρίου

#### ⚡ Ενέργεια & Επικοινωνίες
- ΔΕΗ Κοινοχρήστων
- Νερό Κοινοχρήστων
- Συλλογή Απορριμμάτων
- Διαδίκτυο/Τηλέφωνο

#### 🏠 Θέρμανση & Κλιματισμός
- Πετρέλαιο Θέρμανσης
- Φυσικό Αέριο Θέρμανσης
- Συντήρηση Καυστήρα
- Επιθεώρηση Θερμαντικών

#### 🛡️ Ασφάλεια & Πρόσβαση
- Ασφάλεια Κτιρίου
- Σύστημα Ασφάλειας
- CCTV
- Πυρασφάλεια

### Τρόποι Κατανομής

#### 1. **Ανά Χιλιοστά** (Προτεινόμενο)
- Κατανομή ανάλογα με τα χιλιοστά συμμετοχής
- Χρησιμοποιείται για τις περισσότερες δαπάνες
- Δίκαιη κατανομή βάσει ιδιοκτησίας

#### 2. **Ισόποσα**
- Ίσο ποσό για κάθε διαμέρισμα
- Χρησιμοποιείται για γενικές δαπάνες
- Απλή και εύκολη κατανομή

#### 3. **Συγκεκριμένα**
- Μόνο σε επιλεγμένα διαμερίσματα
- Χρησιμοποιείται για ειδικές δαπάνες
- Ευέλικτη επιλογή

#### 4. **Μετρητές**
- Κατανομή βάσει κατανάλωσης
- Χρησιμοποιείται για θέρμανση/νερό
- Δίκαιη βάσει πραγματικής χρήσης

---

## 💰 Διαχείριση Εισπράξεων

### Δημιουργία Νέας Εισπράξεως

1. **Πρόσβαση**: Μεταβείτε στην καρτέλα "Εισπράξεις"
2. **Επιλογή**: Κάντε κλικ στο "Νέα Εισπράξη"
3. **Συμπλήρωση**:
   - **Διαμέρισμα**: Επιλέξτε το διαμέρισμα
   - **Ποσό**: Το ποσό σε ευρώ
   - **Ημερομηνία**: Ημερομηνία εισπράξεως
   - **Τρόπος Πληρωμής**: Μετρητά, τραπεζική μεταφορά, κλπ.
   - **Σημειώσεις**: Προαιρετικές σημειώσεις
   - **Απόδειξη**: Προαιρετικό αρχείο

4. **Αποθήκευση**: Κάντε κλικ στο "Αποθήκευση"

### Τύποι Εισπράξεων

- **Κοινόχρηστα**: Κανονικά κοινοχρήστων
- **Ταμείο Εφεδρείας**: Ειδικές εισφορές
- **Ειδική Δαπάνη**: Για συγκεκριμένες δαπάνες
- **Προκαταβολή**: Προκαταβολές
- **Άλλο**: Άλλες εισπράξεις

---

## 🧮 Υπολογισμός Κοινοχρήστων

### Υπολογιστής Κοινοχρήστων

1. **Πρόσβαση**: Μεταβείτε στην καρτέλα "Κοινοχρήστων"
2. **Επιλογή Περιόδου**:
   - **Γρήγορη Επιλογή**: Τρέχων/προηγούμενος μήνας
   - **Προσαρμοσμένη Περίοδος**: Επιλέξτε ημερομηνίες

3. **Υπολογισμός**: Κάντε κλικ στο "Υπολογισμός"

### Αποτελέσματα Υπολογισμού

Το σύστημα εμφανίζει:
- **Συνολικές Δαπάνες**: Συνολικό ποσό περιόδου
- **Διαμερίσματα**: Αριθμός διαμερισμάτων
- **Μέσο Όρο**: Μέσο ποσό ανά διαμέρισμα
- **Συνολικό Οφειλόμενο**: Συνολικό οφειλόμενο ποσό

### Μερίδια ανά Διαμέρισμα

Για κάθε διαμέρισμα εμφανίζεται:
- **Ονοματεπώνυμο**: Ιδιοκτήτη/ενοικιαστή
- **Αριθμός**: Αριθμός διαμερίσματος
- **Χιλιοστά**: Χιλιοστά συμμετοχής
- **Ποσό**: Ποσό κοινοχρήστων
- **Προηγούμενο Υπόλοιπο**: Προηγούμενο οφειλόμενο
- **Συνολικό Οφειλόμενο**: Τελικό ποσό

### Φύλλο Κοινοχρήστων

1. **Προβολή**: Κάντε κλικ στο "Φύλλο Κοινοχρήστων"
2. **Χαρακτηριστικά**:
   - **Μικρότερο ύψος**: 85% της οθόνης
   - **Μεγαλύτερο πλάτος**: 95% της οθόνης
   - **3-Column layout**: Καλύτερη οργάνωση
   - **Αποθήκευση**: Κουμπί για αποθήκευση

3. **Ενέργειες**:
   - **Αποθήκευση**: Αποθήκευση στο σύστημα
   - **PDF**: Εξαγωγή σε PDF
   - **Excel**: Εξαγωγή σε Excel
   - **Εκτύπωση**: Άμεση εκτύπωση

---

## 📊 Reports & Analytics

### Διαθέσιμα Reports

#### 1. **Οικονομικό Dashboard**
- Συνολικό αποθεματικό
- Μηνιαίες δαπάνες
- Εισπράξεις vs οφειλές
- Γραφήματα και στατιστικά

#### 2. **Report Δαπανών**
- Ανάλυση ανά κατηγορία
- Ανάλυση ανά χρονικό διάστημα
- Σύγκριση με προηγούμενες περιόδους

#### 3. **Report Εισπράξεων**
- Κατάσταση πληρωμών
- Καθυστερήσεις
- Στατιστικά εισπράξεων

#### 4. **Report Κοινοχρήστων**
- Ιστορικό κοινοχρήστων
- Ανάλυση ανά διαμέρισμα
- Σύγκριση περιόδων

### Εξαγωγή Reports

1. **Επιλογή Report**: Επιλέξτε τον τύπο report
2. **Φιλτράρισμα**: Ορίστε παραμέτρους
3. **Εξαγωγή**: Επιλέξτε μορφή (PDF, Excel)
4. **Λήψη**: Κατεβάστε το αρχείο

---

## 💰 Διαχείριση Αποθεματικού

### Ταμείο Εφεδρείας

Το σύστημα διαχειρίζεται αυτόματα:
- **Εισροές**: Από εισπράξεις κοινοχρήστων
- **Εκροές**: Για δαπάνες κτιρίου
- **Υπόλοιπο**: Τρέχον διαθέσιμο ποσό

### Ειδικές Εισφορές

- **Έκτακτες Εισφορές**: Για μεγάλες δαπάνες
- **Ταμείο Ανακαίνισης**: Για ανακαινίσεις
- **Ταμείο Έκτακτης Ανάγκης**: Για επείγουσες ανάγκες

---

## 🔧 Προηγμένες Λειτουργίες

### Αυτοματισμοί

#### 1. **Αυτόματη Δημιουργία Περιόδων**
- Τριμηνιαία/εξαμηνιαία περιόδους
- Αυτόματη συλλογή δαπανών
- Αυτόματος υπολογισμός μεριδίων

#### 2. **Αυτόματη Έκδοση Λογαριασμών**
- Προγραμματισμένη έκδοση
- Email notifications
- SMS reminders

#### 3. **Αυτόματη Ενημέρωση Υπολοίπων**
- Real-time υπολοίπων
- Αυτόματη χρέωση τόκων
- Προειδοποιήσεις καθυστερήσεων

### Bulk Operations

#### 1. **Μαζική Εισαγωγή Δαπανών**
- CSV/Excel import
- Validation rules
- Error reporting

#### 2. **Μαζική Εισπράξη**
- Bulk payment processing
- Multiple apartments
- Batch confirmation

#### 3. **Μαζική Έκδοση Λογαριασμών**
- Multiple periods
- Custom templates
- Batch processing

---

## 🛠️ Troubleshooting

### Συχνά Προβλήματα

#### 1. **Δαπάνες δεν εμφανίζονται**
- **Λύση**: Ελέγξτε αν έχουν `is_issued=false`
- **Πρόσθεση**: Δημιουργήστε νέες ανέκδοτες δαπάνες

#### 2. **Λάθος υπολογισμός μεριδίων**
- **Λύση**: Ελέγξτε τα χιλιοστά συμμετοχής
- **Πρόσθεση**: Βεβαιωθείτε ότι το σύνολο είναι 1.000

#### 3. **Type errors στο frontend**
- **Λύση**: Ελέγξτε τα type definitions
- **Πρόσθεση**: Ενημερώστε τα TypeScript interfaces

### Debug Scripts

#### 1. **Εντοπισμός Προβλημάτων Δαπανών**
```bash
python3 debug_expenses.py
```

#### 2. **Δημιουργία Ανέκδοτων Δαπανών**
```bash
python3 add_expenses_via_api.py
```

#### 3. **Προσθήκη Χιλιοστών**
```bash
python3 add_mills_to_athens_building.py
```

---

## 📞 Υποστήριξη

### Επικοινωνία
- **Email**: support@newconcierge.com
- **Documentation**: [docs.newconcierge.com](https://docs.newconcierge.com)
- **Issues**: [GitHub Issues](https://github.com/newconcierge/issues)

### Community
- **Discord**: [Join our community](https://discord.gg/newconcierge)
- **Blog**: [Latest updates](https://blog.newconcierge.com)

---

**Last Updated**: December 5, 2024  
**Version**: 2.1.0 