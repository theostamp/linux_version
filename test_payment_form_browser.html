<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Form Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .success-message {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            display: none;
        }
        .error-message {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            display: none;
        }
        .print-button {
            background-color: #28a745;
        }
        .print-button:hover {
            background-color: #218838;
        }
        .new-payment-button {
            background-color: #6c757d;
        }
        .new-payment-button:hover {
            background-color: #545b62;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª Payment Form Test</h1>
        <p>Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î­Î½Î± test Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾Î¿Ï…Î¼Îµ Î±Î½ Ï„Î¿ PaymentForm Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ ÏƒÏ‰ÏƒÏ„Î¬.</p>
        
        <form id="paymentForm">
            <div class="form-group">
                <label for="apartment">Î”Î¹Î±Î¼Î­ÏÎ¹ÏƒÎ¼Î± *</label>
                <select id="apartment" required>
                    <option value="">Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Î´Î¹Î±Î¼Î­ÏÎ¹ÏƒÎ¼Î±</option>
                    <option value="1">Î‘1 - Î™Î´Î¹Î¿ÎºÏ„Î®Ï„Î·Ï‚ Test</option>
                    <option value="2">Î‘2 - Î•Î½Î¿Î¹ÎºÎ¹Î±ÏƒÏ„Î®Ï‚ Test</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="amount">Î Î¿ÏƒÏŒ (â‚¬) *</label>
                <input type="number" id="amount" step="0.01" min="0" required placeholder="0.00">
            </div>
            
            <div class="form-group">
                <label for="date">Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± *</label>
                <input type="date" id="date" required>
            </div>
            
            <div class="form-group">
                <label for="method">ÎœÎ­Î¸Î¿Î´Î¿Ï‚ Î•Î¹ÏƒÏ€ÏÎ¬Î¾ÎµÏ‰Ï‚ *</label>
                <select id="method" required>
                    <option value="">Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Î¼Î­Î¸Î¿Î´Î¿</option>
                    <option value="cash">ÎœÎµÏ„ÏÎ·Ï„Î¬</option>
                    <option value="bank_transfer">Î¤ÏÎ±Ï€ÎµÎ¶Î¹ÎºÎ® ÎœÎµÏ„Î±Ï†Î¿ÏÎ¬</option>
                    <option value="check">Î•Ï€Î¹Ï„Î±Î³Î®</option>
                    <option value="card">ÎšÎ¬ÏÏ„Î±</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="payment_type">Î¤ÏÏ€Î¿Ï‚ Î•Î¹ÏƒÏ€ÏÎ¬Î¾ÎµÏ‰Ï‚ *</label>
                <select id="payment_type" required>
                    <option value="">Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Ï„ÏÏ€Î¿</option>
                    <option value="common_expense">ÎšÎ¿Î¹Î½ÏŒÏ‡ÏÎ·ÏƒÏ„Î±</option>
                    <option value="reserve_fund">Î¤Î±Î¼ÎµÎ¯Î¿ Î•Ï†ÎµÎ´ÏÎµÎ¯Î±Ï‚</option>
                    <option value="special_expense">Î•Î¹Î´Î¹ÎºÎ® Î”Î±Ï€Î¬Î½Î·</option>
                    <option value="advance">Î ÏÎ¿ÎºÎ±Ï„Î±Î²Î¿Î»Î®</option>
                    <option value="other">Î†Î»Î»Î¿</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="payer_type">Î Î»Î·ÏÏ‰Ï„Î®Ï‚ *</label>
                <select id="payer_type" required>
                    <option value="">Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Ï€Î»Î·ÏÏ‰Ï„Î®</option>
                    <option value="owner">Î™Î´Î¹Î¿ÎºÏ„Î®Ï„Î·Ï‚</option>
                    <option value="tenant">Î•Î½Î¿Î¹ÎºÎ¹Î±ÏƒÏ„Î®Ï‚</option>
                    <option value="other">Î†Î»Î»Î¿Ï‚</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="payer_name">ÎŒÎ½Î¿Î¼Î± Î Î»Î·ÏÏ‰Ï„Î®</label>
                <input type="text" id="payer_name" placeholder="Î˜Î± ÏƒÏ…Î¼Ï€Î»Î·ÏÏ‰Î¸ÎµÎ¯ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î±">
            </div>
            
            <div class="form-group">
                <label for="reference_number">Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î‘Î½Î±Ï†Î¿ÏÎ¬Ï‚</label>
                <input type="text" id="reference_number" placeholder="Ï€.Ï‡. Î¤ÏÎ±Ï€ÎµÎ¶Î¹ÎºÎ® Î±Î½Î±Ï†Î¿ÏÎ¬">
            </div>
            
            <div class="form-group">
                <label for="notes">Î£Î·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚</label>
                <textarea id="notes" rows="3" placeholder="Î ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÎ­Ï‚ ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚"></textarea>
            </div>
            
            <button type="submit">ÎšÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ· Î•Î¹ÏƒÏ€ÏÎ¬Î¾ÎµÏ‰Ï‚</button>
        </form>
        
        <div id="successMessage" class="success-message">
            <h3>âœ… Î•Ï€Î¹Ï„Ï…Ï‡Î®Ï‚ ÎšÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ·!</h3>
            <p>Î— ÎµÎ¯ÏƒÏ€ÏÎ±Î¾Î· ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ®Î¸Î·ÎºÎµ ÎµÏ€Î¹Ï„Ï…Ï‡ÏÏ‚ Î³Î¹Î± Ï„Î¿ Î´Î¹Î±Î¼Î­ÏÎ¹ÏƒÎ¼Î± <span id="apartmentNumber"></span></p>
            <div>
                <button class="print-button" onclick="printReceipt()">ğŸ–¨ï¸ Î•ÎºÏ„ÏÏ€Ï‰ÏƒÎ· Î‘Ï€ÏŒÎ´ÎµÎ¹Î¾Î·Ï‚</button>
                <button class="new-payment-button" onclick="resetForm()">ÎÎ­Î± Î•Î¯ÏƒÏ€ÏÎ±Î¾Î·</button>
            </div>
        </div>
        
        <div id="errorMessage" class="error-message">
            <h3>âŒ Î£Ï†Î¬Î»Î¼Î±</h3>
            <p id="errorText"></p>
        </div>
    </div>

    <script>
        // Set default date to today
        document.getElementById('date').value = new Date().toISOString().split('T')[0];
        
        let createdPayment = null;
        
        document.getElementById('paymentForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                apartment_id: parseInt(document.getElementById('apartment').value),
                amount: parseFloat(document.getElementById('amount').value),
                date: document.getElementById('date').value,
                method: document.getElementById('method').value,
                payment_type: document.getElementById('payment_type').value,
                payer_type: document.getElementById('payer_type').value,
                payer_name: document.getElementById('payer_name').value,
                reference_number: document.getElementById('reference_number').value,
                notes: document.getElementById('notes').value
            };
            
            console.log('Submitting payment data:', formData);
            
            try {
                // Simulate API call
                const response = await simulatePaymentCreation(formData);
                
                if (response.success) {
                    createdPayment = response.payment;
                    showSuccessMessage(createdPayment);
                    console.log('Payment created successfully:', createdPayment);
                } else {
                    showErrorMessage(response.error);
                }
            } catch (error) {
                console.error('Error creating payment:', error);
                showErrorMessage('Î ÏÎ¿Î­ÎºÏ…ÏˆÎµ ÏƒÏ†Î¬Î»Î¼Î± ÎºÎ±Ï„Î¬ Ï„Î·Î½ ÎºÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ· Ï„Î·Ï‚ ÎµÎ¹ÏƒÏ€ÏÎ¬Î¾ÎµÏ‰Ï‚.');
            }
        });
        
        function simulatePaymentCreation(data) {
            return new Promise((resolve) => {
                // Simulate API delay
                setTimeout(() => {
                    // Simulate successful payment creation
                    const payment = {
                        id: Math.floor(Math.random() * 1000) + 1,
                        apartment_number: `A${data.apartment_id}`,
                        amount: data.amount,
                        date: data.date,
                        method: data.method,
                        payment_type: data.payment_type,
                        payer_name: data.payer_name || 'Test Payer',
                        building_name: 'Test Building'
                    };
                    
                    resolve({
                        success: true,
                        payment: payment
                    });
                }, 1000);
            });
        }
        
        function showSuccessMessage(payment) {
            document.getElementById('apartmentNumber').textContent = payment.apartment_number;
            document.getElementById('successMessage').style.display = 'block';
            document.getElementById('errorMessage').style.display = 'none';
        }
        
        function showErrorMessage(message) {
            document.getElementById('errorText').textContent = message;
            document.getElementById('errorMessage').style.display = 'block';
            document.getElementById('successMessage').style.display = 'none';
        }
        
        function printReceipt() {
            if (!createdPayment) {
                alert('Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï€Î»Î·ÏÏ‰Î¼Î® Î³Î¹Î± ÎµÎºÏ„ÏÏ€Ï‰ÏƒÎ·');
                return;
            }
            
            console.log('Printing receipt for payment:', createdPayment);
            
            // Simulate print functionality
            const receiptContent = `
                Î‘Î ÎŸÎ”Î•Î™ÎÎ— Î•Î™Î£Î Î¡Î‘ÎÎ•Î©Î£
                
                Î”Î¹Î±Î¼Î­ÏÎ¹ÏƒÎ¼Î±: ${createdPayment.apartment_number}
                Î Î¿ÏƒÏŒ: ${createdPayment.amount}â‚¬
                Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±: ${createdPayment.date}
                ÎœÎ­Î¸Î¿Î´Î¿Ï‚: ${createdPayment.method}
                Î Î»Î·ÏÏ‰Ï„Î®Ï‚: ${createdPayment.payer_name}
                
                QR Code: /verify-payment/${createdPayment.id}
            `;
            
            alert('Î•ÎºÏ„ÏÏ€Ï‰ÏƒÎ· Î±Ï€ÏŒÎ´ÎµÎ¹Î¾Î·Ï‚:\n\n' + receiptContent);
        }
        
        function resetForm() {
            document.getElementById('paymentForm').reset();
            document.getElementById('date').value = new Date().toISOString().split('T')[0];
            document.getElementById('successMessage').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'none';
            createdPayment = null;
        }
        
        // Auto-fill payer name based on apartment selection
        document.getElementById('apartment').addEventListener('change', function() {
            const apartmentId = this.value;
            const payerType = document.getElementById('payer_type').value;
            
            if (apartmentId && payerType) {
                let payerName = '';
                if (payerType === 'owner') {
                    payerName = 'Î™Î´Î¹Î¿ÎºÏ„Î®Ï„Î·Ï‚ Test';
                } else if (payerType === 'tenant') {
                    payerName = 'Î•Î½Î¿Î¹ÎºÎ¹Î±ÏƒÏ„Î®Ï‚ Test';
                }
                document.getElementById('payer_name').value = payerName;
            }
        });
        
        document.getElementById('payer_type').addEventListener('change', function() {
            const apartmentId = document.getElementById('apartment').value;
            const payerType = this.value;
            
            if (apartmentId && payerType) {
                let payerName = '';
                if (payerType === 'owner') {
                    payerName = 'Î™Î´Î¹Î¿ÎºÏ„Î®Ï„Î·Ï‚ Test';
                } else if (payerType === 'tenant') {
                    payerName = 'Î•Î½Î¿Î¹ÎºÎ¹Î±ÏƒÏ„Î®Ï‚ Test';
                }
                document.getElementById('payer_name').value = payerName;
            }
        });
    </script>
</body>
</html>
