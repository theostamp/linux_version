# Generated by Django 5.2.8 on 2025-12-08 21:15

import django.core.validators
import django.db.models.deletion
import uuid
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('announcements', '0007_migrate_project_to_projects_and_remove_single_project'),
        ('apartments', '0011_apartment_kiosk_token'),
        ('buildings', '0026_internal_manager_framework'),
        ('projects', '0007_alter_offer_installments_alter_project_installments'),
        ('votes', '0004_vote_project'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='AgendaItem',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('order', models.PositiveIntegerField(verbose_name='Σειρά')),
                ('title', models.CharField(max_length=255, verbose_name='Τίτλος Θέματος')),
                ('description', models.TextField(blank=True, verbose_name='Περιγραφή')),
                ('item_type', models.CharField(choices=[('informational', 'Ενημερωτικό'), ('discussion', 'Συζήτηση'), ('voting', 'Ψηφοφορία'), ('approval', 'Έγκριση')], default='discussion', max_length=20, verbose_name='Τύπος Θέματος')),
                ('estimated_duration', models.PositiveIntegerField(default=10, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(180)], verbose_name='Εκτιμώμενη Διάρκεια (λεπτά)')),
                ('actual_duration', models.PositiveIntegerField(blank=True, null=True, verbose_name='Πραγματική Διάρκεια (λεπτά)')),
                ('started_at', models.DateTimeField(blank=True, null=True, verbose_name='Ώρα Έναρξης')),
                ('ended_at', models.DateTimeField(blank=True, null=True, verbose_name='Ώρα Λήξης')),
                ('presenter_name', models.CharField(blank=True, help_text='Αν ο εισηγητής δεν είναι χρήστης', max_length=255, verbose_name='Όνομα Εισηγητή')),
                ('status', models.CharField(choices=[('pending', 'Εκκρεμεί'), ('in_progress', 'Σε Εξέλιξη'), ('completed', 'Ολοκληρώθηκε'), ('deferred', 'Αναβλήθηκε'), ('cancelled', 'Ακυρώθηκε')], default='pending', max_length=20, verbose_name='Κατάσταση')),
                ('voting_type', models.CharField(choices=[('simple_majority', 'Απλή Πλειοψηφία (>50%)'), ('qualified_majority', 'Ειδική Πλειοψηφία (2/3)'), ('unanimous', 'Ομοφωνία'), ('relative_majority', 'Σχετική Πλειοψηφία')], default='simple_majority', max_length=20, verbose_name='Τύπος Ψηφοφορίας')),
                ('allows_pre_voting', models.BooleanField(default=True, verbose_name='Επιτρέπει Pre-voting')),
                ('decision', models.TextField(blank=True, help_text='Η απόφαση που λήφθηκε για αυτό το θέμα', verbose_name='Απόφαση')),
                ('decision_type', models.CharField(blank=True, choices=[('approved', 'Εγκρίθηκε'), ('rejected', 'Απορρίφθηκε'), ('deferred', 'Αναβλήθηκε'), ('amended', 'Εγκρίθηκε με Τροποποιήσεις'), ('no_decision', 'Χωρίς Απόφαση')], max_length=20, verbose_name='Τύπος Απόφασης')),
                ('discussion_notes', models.TextField(blank=True, verbose_name='Σημειώσεις Συζήτησης')),
                ('has_attachments', models.BooleanField(default=False, verbose_name='Έχει Συνημμένα')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('linked_project', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='agenda_items', to='projects.project', verbose_name='Συνδεδεμένο Έργο')),
                ('linked_vote', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='agenda_item', to='votes.vote', verbose_name='Συνδεδεμένη Ψηφοφορία')),
                ('presenter', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='presented_agenda_items', to=settings.AUTH_USER_MODEL, verbose_name='Εισηγητής')),
            ],
            options={
                'verbose_name': 'Θέμα Ημερήσιας Διάταξης',
                'verbose_name_plural': 'Θέματα Ημερήσιας Διάταξης',
                'ordering': ['assembly', 'order'],
            },
        ),
        migrations.CreateModel(
            name='AgendaItemAttachment',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('file', models.FileField(upload_to='assemblies/attachments/%Y/%m/', verbose_name='Αρχείο')),
                ('filename', models.CharField(max_length=255, verbose_name='Όνομα Αρχείου')),
                ('file_type', models.CharField(blank=True, max_length=50, verbose_name='Τύπος')),
                ('file_size', models.PositiveIntegerField(blank=True, null=True, verbose_name='Μέγεθος (bytes)')),
                ('description', models.TextField(blank=True, verbose_name='Περιγραφή')),
                ('uploaded_at', models.DateTimeField(auto_now_add=True)),
                ('agenda_item', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='attachments', to='assemblies.agendaitem', verbose_name='Θέμα')),
                ('uploaded_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='Ανέβηκε από')),
            ],
            options={
                'verbose_name': 'Συνημμένο Θέματος',
                'verbose_name_plural': 'Συνημμένα Θεμάτων',
                'ordering': ['uploaded_at'],
            },
        ),
        migrations.CreateModel(
            name='Assembly',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('title', models.CharField(max_length=255, verbose_name='Τίτλος Συνέλευσης')),
                ('assembly_type', models.CharField(choices=[('regular', 'Τακτική'), ('extraordinary', 'Έκτακτη'), ('continuation', 'Συνέχιση Αναβληθείσας')], default='regular', max_length=20, verbose_name='Τύπος Συνέλευσης')),
                ('description', models.TextField(blank=True, verbose_name='Περιγραφή/Σκοπός')),
                ('scheduled_date', models.DateField(verbose_name='Ημερομηνία Συνέλευσης')),
                ('scheduled_time', models.TimeField(verbose_name='Ώρα Έναρξης')),
                ('estimated_duration', models.PositiveIntegerField(default=60, verbose_name='Εκτιμώμενη Διάρκεια (λεπτά)')),
                ('is_physical', models.BooleanField(default=True, verbose_name='Φυσική Παρουσία')),
                ('is_online', models.BooleanField(default=False, verbose_name='Διαδικτυακή Συμμετοχή')),
                ('location', models.CharField(blank=True, help_text='π.χ. Pilotis, Αίθουσα Α2', max_length=255, verbose_name='Τοποθεσία')),
                ('meeting_link', models.URLField(blank=True, verbose_name='Σύνδεσμος Τηλεδιάσκεψης')),
                ('meeting_id', models.CharField(blank=True, max_length=50, verbose_name='Meeting ID')),
                ('meeting_password', models.CharField(blank=True, max_length=100, verbose_name='Κωδικός Meeting')),
                ('total_building_mills', models.PositiveIntegerField(default=1000, verbose_name='Συνολικά χιλιοστά Κτιρίου')),
                ('required_quorum_percentage', models.DecimalField(decimal_places=2, default=Decimal('50.01'), max_digits=5, validators=[django.core.validators.MinValueValidator(Decimal('0')), django.core.validators.MaxValueValidator(Decimal('100'))], verbose_name='Απαιτούμενο Ποσοστό Απαρτίας (%)')),
                ('achieved_quorum_mills', models.PositiveIntegerField(default=0, verbose_name='Επιτευχθέντα χιλιοστά')),
                ('quorum_achieved', models.BooleanField(default=False, verbose_name='Επετεύχθη Απαρτία')),
                ('quorum_achieved_at', models.DateTimeField(blank=True, null=True, verbose_name='Ώρα Επίτευξης Απαρτίας')),
                ('status', models.CharField(choices=[('draft', 'Προσχέδιο'), ('scheduled', 'Προγραμματισμένη'), ('convened', 'Συγκληθείσα'), ('in_progress', 'Σε Εξέλιξη'), ('completed', 'Ολοκληρωμένη'), ('cancelled', 'Ακυρωμένη'), ('adjourned', 'Αναβλήθηκε')], default='draft', max_length=20, verbose_name='Κατάσταση')),
                ('actual_start_time', models.DateTimeField(blank=True, null=True, verbose_name='Πραγματική Ώρα Έναρξης')),
                ('actual_end_time', models.DateTimeField(blank=True, null=True, verbose_name='Πραγματική Ώρα Λήξης')),
                ('pre_voting_enabled', models.BooleanField(default=True, help_text='Επιτρέπει ψηφοφορία πριν τη συνέλευση', verbose_name='Ενεργοποίηση Pre-voting')),
                ('pre_voting_start_date', models.DateField(blank=True, null=True, verbose_name='Έναρξη Pre-voting')),
                ('pre_voting_end_date', models.DateField(blank=True, help_text='Συνήθως η ημέρα πριν τη συνέλευση', null=True, verbose_name='Λήξη Pre-voting')),
                ('minutes_text', models.TextField(blank=True, verbose_name='Κείμενο Πρακτικών')),
                ('minutes_approved', models.BooleanField(default=False, verbose_name='Εγκρίθηκαν τα Πρακτικά')),
                ('minutes_approved_at', models.DateTimeField(blank=True, null=True, verbose_name='Ημερομηνία Έγκρισης Πρακτικών')),
                ('invitation_sent', models.BooleanField(default=False, verbose_name='Εστάλη Πρόσκληση')),
                ('invitation_sent_at', models.DateTimeField(blank=True, null=True, verbose_name='Ώρα Αποστολής Πρόσκλησης')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Ημερομηνία Δημιουργίας')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Τελευταία Ενημέρωση')),
                ('building', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assemblies', to='buildings.building', verbose_name='Κτίριο')),
                ('continued_from', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='continuations', to='assemblies.assembly', verbose_name='Συνέχεια από')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_assemblies', to=settings.AUTH_USER_MODEL, verbose_name='Δημιουργήθηκε από')),
                ('linked_announcement', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assemblies', to='announcements.announcement', verbose_name='Συνδεδεμένη Ανακοίνωση')),
                ('minutes_approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_assembly_minutes', to=settings.AUTH_USER_MODEL, verbose_name='Εγκρίθηκαν από')),
            ],
            options={
                'verbose_name': 'Γενική Συνέλευση',
                'verbose_name_plural': 'Γενικές Συνελεύσεις',
                'ordering': ['-scheduled_date', '-scheduled_time'],
            },
        ),
        migrations.AddField(
            model_name='agendaitem',
            name='assembly',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='agenda_items', to='assemblies.assembly', verbose_name='Συνέλευση'),
        ),
        migrations.CreateModel(
            name='AssemblyAttendee',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('mills', models.PositiveIntegerField(verbose_name='χιλιοστά')),
                ('rsvp_status', models.CharField(choices=[('pending', 'Αναμένεται'), ('attending', 'Θα Παρευρεθεί'), ('not_attending', 'Δεν θα Παρευρεθεί'), ('maybe', 'Ίσως')], default='pending', max_length=20, verbose_name='RSVP')),
                ('rsvp_at', models.DateTimeField(blank=True, null=True, verbose_name='Ώρα RSVP')),
                ('rsvp_notes', models.TextField(blank=True, verbose_name='Σημειώσεις RSVP')),
                ('attendance_type', models.CharField(blank=True, choices=[('in_person', 'Φυσική Παρουσία'), ('online', 'Διαδικτυακά'), ('proxy', 'Με Εξουσιοδότηση'), ('pre_vote_only', 'Μόνο Pre-voting')], max_length=20, verbose_name='Τύπος Παρουσίας')),
                ('is_present', models.BooleanField(default=False, verbose_name='Παρών')),
                ('checked_in_at', models.DateTimeField(blank=True, null=True, verbose_name='Ώρα Check-in')),
                ('checked_out_at', models.DateTimeField(blank=True, null=True, verbose_name='Ώρα Αποχώρησης')),
                ('is_proxy', models.BooleanField(default=False, verbose_name='Είναι Εξουσιοδότηση')),
                ('proxy_document', models.FileField(blank=True, upload_to='assemblies/proxies/%Y/%m/', verbose_name='Έγγραφο Εξουσιοδότησης')),
                ('has_pre_voted', models.BooleanField(default=False, verbose_name='Έχει Pre-voted')),
                ('pre_voted_at', models.DateTimeField(blank=True, null=True, verbose_name='Ώρα Pre-vote')),
                ('attendee_name', models.CharField(blank=True, help_text='Αν δεν είναι εγγεγραμμένος χρήστης', max_length=255, verbose_name='Όνομα Παρόντος')),
                ('attendee_phone', models.CharField(blank=True, max_length=20, verbose_name='Τηλέφωνο')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('apartment', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assembly_attendances', to='apartments.apartment', verbose_name='Διαμέρισμα')),
                ('assembly', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='attendees', to='assemblies.assembly', verbose_name='Συνέλευση')),
                ('proxy_from_apartment', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='proxy_given_to', to='apartments.apartment', verbose_name='Εξουσιοδότηση από')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assembly_attendances', to=settings.AUTH_USER_MODEL, verbose_name='Χρήστης')),
            ],
            options={
                'verbose_name': 'Παρών Συνέλευσης',
                'verbose_name_plural': 'Παρόντες Συνέλευσης',
                'ordering': ['apartment__number'],
                'unique_together': {('assembly', 'apartment')},
            },
        ),
        migrations.CreateModel(
            name='AssemblyMinutesTemplate',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=100, verbose_name='Όνομα Template')),
                ('description', models.TextField(blank=True, verbose_name='Περιγραφή')),
                ('header_template', models.TextField(help_text='Placeholders: {building_name}, {assembly_date}, {assembly_time}, {location}', verbose_name='Header Template')),
                ('agenda_item_template', models.TextField(help_text='Placeholders: {order}, {title}, {description}, {decision}, {vote_results}', verbose_name='Agenda Item Template')),
                ('attendees_template', models.TextField(help_text='Placeholders: {attendees_list}, {total_mills}, {quorum_percentage}', verbose_name='Attendees Template')),
                ('footer_template', models.TextField(help_text='Placeholders: {end_time}, {secretary_name}, {chairman_name}', verbose_name='Footer Template')),
                ('is_default', models.BooleanField(default=False, verbose_name='Προεπιλεγμένο')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('building', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='minutes_templates', to='buildings.building', verbose_name='Κτίριο')),
            ],
            options={
                'verbose_name': 'Template Πρακτικών',
                'verbose_name_plural': 'Templates Πρακτικών',
                'ordering': ['-is_default', 'name'],
            },
        ),
        migrations.AlterUniqueTogether(
            name='agendaitem',
            unique_together={('assembly', 'order')},
        ),
        migrations.CreateModel(
            name='AssemblyVote',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('vote', models.CharField(choices=[('approve', 'Υπέρ'), ('reject', 'Κατά'), ('abstain', 'Λευκό')], max_length=10, verbose_name='Ψήφος')),
                ('mills', models.PositiveIntegerField(verbose_name='χιλιοστά Ψήφου')),
                ('vote_source', models.CharField(choices=[('pre_vote', 'Pre-voting'), ('live', 'Κατά τη Συνέλευση'), ('proxy', 'Με Εξουσιοδότηση')], default='live', max_length=10, verbose_name='Πηγή Ψήφου')),
                ('notes', models.TextField(blank=True, verbose_name='Σημειώσεις')),
                ('voted_at', models.DateTimeField(auto_now_add=True, verbose_name='Ώρα Ψήφου')),
                ('agenda_item', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assembly_votes', to='assemblies.agendaitem', verbose_name='Θέμα')),
                ('attendee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='votes', to='assemblies.assemblyattendee', verbose_name='Ψηφοφόρος')),
                ('voted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='proxy_votes_cast', to=settings.AUTH_USER_MODEL, verbose_name='Ψήφισε αντί του')),
            ],
            options={
                'verbose_name': 'Ψήφος Συνέλευσης',
                'verbose_name_plural': 'Ψήφοι Συνέλευσης',
                'ordering': ['voted_at'],
                'unique_together': {('agenda_item', 'attendee')},
            },
        ),
    ]
