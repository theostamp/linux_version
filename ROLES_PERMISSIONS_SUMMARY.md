# Σύνοψη Ρόλων και Δικαιωμάτων: Internal Manager vs Resident

## 📊 Ιεραρχία Ρόλων

```
Superuser/Staff > Office Manager > Internal Manager > Resident
```

---

## 🏢 Internal Manager (Εσωτερικός Διαχειριστής)

### 📍 Πεδίο Εφαρμογής
- **Μόνο στη δική του πολυκατοικία** (όπου είναι ορισμένος ως `internal_manager`)
- Ένας user μπορεί να είναι internal manager **μόνο σε μία** πολυκατοικία

### ✅ Τι Μπορεί να Κάνει

#### 1. **Οικονομικά (Financials)**
- ✅ **Προβολή**: Μπορεί να βλέπει όλα τα οικονομικά στοιχεία
  - Δαπάνες (Expenses) - **Read-only**
  - Πληρωμές (Payments) - **Read-only**
  - Υπόλοιπα (Balances) - **Read-only**
  - Συναλλαγές (Transactions) - **Read-only**

- ⚠️ **Καταχώρηση Πληρωμών**: **Opt-in** (μόνο αν έχει `can_record_payments = True`)
  - Μπορεί να καταχωρεί πληρωμές (Payments)
  - **ΔΕΝ** μπορεί να δημιουργεί/επεξεργάζεται δαπάνες (Expenses)
  - **ΔΕΝ** μπορεί να διαγράψει πληρωμές

#### 2. **Συνελεύσεις (Assemblies/Meetings)**
- ✅ **Δημιουργία**: Μπορεί να δημιουργεί συνελεύσεις
- ✅ **Επεξεργασία**: Μπορεί να επεξεργάζεται συνελεύσεις
- ✅ **Διαχείριση**: Πλήρης πρόσβαση στις συνελεύσεις

#### 3. **Προσφορές/Έργα (Offers/Projects)**
- ✅ **Διαχείριση**: Μπορεί να διαχειρίζεται προσφορές και έργα
- ✅ **Δημιουργία**: Μπορεί να δημιουργεί προσφορές
- ✅ **Επεξεργασία**: Μπορεί να επεξεργάζεται προσφορές

#### 4. **Προβολή Δεδομένων**
- ✅ Προβολή διαμερισμάτων
- ✅ Προβολή ενοίκων/ιδιοκτητών
- ✅ Προβολή ανακοινώσεων
- ✅ Προβολή συντήρησης (Maintenance)

### ❌ Τι ΔΕΝ Μπορεί να Κάνει

- ❌ **Διαχείριση Κτιρίου**: Δεν μπορεί να επεξεργάζεται τα στοιχεία του κτιρίου
- ❌ **Διαχείριση Δαπανών**: Δεν μπορεί να δημιουργεί/επεξεργάζεται/διαγράφει δαπάνες
- ❌ **Διαγραφή Πληρωμών**: Δεν μπορεί να διαγράψει πληρωμές (ακόμα και αν μπορεί να τις καταχωρεί)
- ❌ **Πρόσβαση σε Άλλα Κτίρια**: Μόνο στη δική του πολυκατοικία
- ❌ **Admin Functions**: Δεν έχει admin-level permissions

---

## 👤 Resident (Ένοικος/Ιδιοκτήτης)

### 📍 Πεδίο Εφαρμογής
- **Μόνο στη δική του πολυκατοικία** (όπου έχει membership)
- Μπορεί να είναι resident σε **πολλαπλές** πολυκατοικίες

### ✅ Τι Μπορεί να Κάνει

#### 1. **Οικονομικά (Financials)**
- ✅ **Προβολή**: Μπορεί να βλέπει τα οικονομικά στοιχεία **μόνο της δικής του πολυκατοικίας**
  - Δαπάνες (Expenses) - **Read-only**
  - Πληρωμές (Payments) - **Read-only** (μόνο τις δικές του)
  - Υπόλοιπο (Balance) - **Read-only** (μόνο το δικό του)
  - Συναλλαγές (Transactions) - **Read-only** (μόνο οι δικές του)

- ❌ **Καταχώρηση**: **ΔΕΝ** μπορεί να καταχωρεί πληρωμές
- ❌ **Διαχείριση**: **ΔΕΝ** μπορεί να δημιουργεί/επεξεργάζεται/διαγράφει οικονομικά στοιχεία

#### 2. **Συνελεύσεις (Assemblies/Meetings)**
- ✅ **Προβολή**: Μπορεί να βλέπει συνελεύσεις
- ✅ **Συμμετοχή**: Μπορεί να συμμετέχει σε συνελεύσεις
- ✅ **Ψήφος**: Μπορεί να ψηφίζει σε θέματα συνελεύσεων
- ❌ **Δημιουργία**: **ΔΕΝ** μπορεί να δημιουργεί συνελεύσεις

#### 3. **Προσφορές/Έργα (Offers/Projects)**
- ✅ **Προβολή**: Μπορεί να βλέπει προσφορές και έργα
- ✅ **Συμμετοχή**: Μπορεί να συμμετέχει σε έργα
- ✅ **Ψήφος**: Μπορεί να ψηφίζει σε προσφορές
- ❌ **Διαχείριση**: **ΔΕΝ** μπορεί να διαχειρίζεται προσφορές

#### 4. **Αναφορά Βλαβών (Maintenance Requests)**
- ✅ **Δημιουργία**: Μπορεί να δημιουργεί αναφορές βλαβών (Maintenance Tickets)
- ✅ **Προβολή**: Μπορεί να βλέπει αναφορές βλαβών (μόνο για τη δική του πολυκατοικία)
- ❌ **Επεξεργασία/Διαγραφή**: Δεν μπορεί να επεξεργάζεται ή να διαγράφει αναφορές (μόνο Office Managers)

#### 5. **Προβολή Δεδομένων**
- ✅ Προβολή διαμερισμάτων (μόνο το δικό του)
- ✅ Προβολή ανακοινώσεων
- ✅ Προβολή συντήρησης (μόνο τα δικά του αιτήματα)

### ❌ Τι ΔΕΝ Μπορεί να Κάνει

- ❌ **Οικονομική Διαχείριση**: Καμία write access στα οικονομικά
- ❌ **Διαχείριση Κτιρίου**: Δεν μπορεί να επεξεργάζεται στοιχεία κτιρίου
- ❌ **Διαχείριση Συνελεύσεων**: Δεν μπορεί να δημιουργεί συνελεύσεις
- ❌ **Διαχείριση Προσφορών**: Δεν μπορεί να διαχειρίζεται προσφορές
- ❌ **Πρόσβαση σε Άλλα Κτίρια**: Μόνο στη δική του πολυκατοικία

---

## 🔄 Σύγκριση: Internal Manager vs Resident

| Δυνατότητα | Internal Manager | Resident |
|------------|------------------|----------|
| **Προβολή Οικονομικών** | ✅ Όλα (read-only) | ✅ Μόνο δικά του |
| **Καταχώρηση Πληρωμών** | ⚠️ Opt-in (με άδεια) | ❌ Όχι |
| **Διαχείριση Δαπανών** | ❌ Όχι | ❌ Όχι |
| **Δημιουργία Συνελεύσεων** | ✅ Ναι | ❌ Όχι |
| **Ψήφος σε Συνελεύσεις** | ✅ Ναι | ✅ Ναι |
| **Διαχείριση Προσφορών** | ✅ Ναι | ❌ Όχι |
| **Ψήφος σε Προσφορές** | ✅ Ναι | ✅ Ναι |
| **Αναφορά Βλαβών** | ✅ Δημιουργία/Προβολή | ✅ Δημιουργία/Προβολή |
| **Πεδίο Εφαρμογής** | 1 πολυκατοικία | Πολλαπλές |

---

## 🔐 Permissions Classes

### Backend Permissions

#### Internal Manager
- `IsInternalManager` - Base permission
- `IsInternalManagerOfBuilding` - Object-level permission
- `IsInternalManagerWithPaymentRights` - Με δικαίωμα πληρωμών

#### Resident
- `IsResident` - Base permission
- `IsResidentOfBuilding` - Object-level permission

#### Financial Permissions
- `FinancialReadPermission` - Read access για internal managers και residents
- `ExpensePermission` - Read-only για internal managers και residents
- `PaymentPermission` - Write access για internal managers (opt-in)

---

## 📝 Σημαντικές Σημειώσεις

### Internal Manager
1. **Opt-in Payments**: Χρειάζεται explicit άδεια (`can_record_payments = True`)
2. **Single Building**: Μόνο σε μία πολυκατοικία
3. **Read-First**: Default permissions είναι read-only, write access είναι opt-in
4. **No Expense Management**: Δεν μπορεί να διαχειρίζεται δαπάνες (μόνο Office Manager)

### Resident
1. **Read-Only**: Πλήρως read-only στα οικονομικά
2. **Multiple Buildings**: Μπορεί να είναι resident σε πολλαπλές πολυκατοικίες
3. **Participation**: Μπορεί να συμμετέχει και να ψηφίζει σε συνελεύσεις/προσφορές
4. **Requests**: Μπορεί να δημιουργεί αιτήματα συντήρησης

---

## ✅ Συμπέρασμα

**Ναι, έχουμε διαμορφώσει τους ρόλους** με σαφείς διαφορές:

- **Internal Manager**: Περιορισμένη διαχείριση (read + opt-in payments + assemblies + offers)
- **Resident**: Read-only + συμμετοχή (ψήφοι, αιτήματα)

Και οι δύο ρόλοι έχουν **περιορισμένη πρόσβαση** (μόνο στη δική τους πολυκατοικία), αλλά με διαφορετικά επίπεδα δικαιωμάτων.

