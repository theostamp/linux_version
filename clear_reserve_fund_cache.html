<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Reserve Fund Cache</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        .button:hover {
            background: #0056b3;
        }
        .button.danger {
            background: #dc3545;
        }
        .button.danger:hover {
            background: #c82333;
        }
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Reserve Fund Cache</h1>
        
        <div class="info">
            <strong>Î ÏÏŒÎ²Î»Î·Î¼Î±:</strong> Î¤Î¿ dashboard ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ hardcoded Ï„Î¹Î¼Î­Ï‚ Î³Î¹Î± Ï„Î¿ Î±Ï€Î¿Î¸ÎµÎ¼Î±Ï„Î¹ÎºÏŒ (10.000â‚¬, 24 Î¼Î®Î½ÎµÏ‚, 416,67â‚¬) Ï€Î¿Ï… Î´ÎµÎ½ ÎµÎ½Î·Î¼ÎµÏÏÎ½Î¿Î½Ï„Î±Î¹.
        </div>
        
        <h2>ğŸ“Š Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· localStorage</h2>
        <div id="currentState">
            <p>Î¦Î¿ÏÏ„ÏÎ½ÎµÏ„Î±Î¹...</p>
        </div>
        
        <h2>ğŸ› ï¸ Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚</h2>
        <button class="button" onclick="showCurrentState()">ğŸ”„ Î‘Î½Î±Î½Î­Ï‰ÏƒÎ· ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚</button>
        <button class="button danger" onclick="clearAllReserveFundData()">ğŸ—‘ï¸ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÎŒÎ»Ï‰Î½ Ï„Ï‰Î½ Reserve Fund Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½</button>
        <button class="button" onclick="clearSpecificBuildingData()">ğŸ¢ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÎšÏ„Î¹ÏÎ¯Î¿Ï… 4 (Î‘Î»ÎºÎ¼Î¬Î½Î¿Ï‚ 22)</button>
        <button class="button" onclick="setDefaultValues()">âš™ï¸ ÎŸÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î ÏÎ¿ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Ï‰Î½ Î¤Î¹Î¼ÏÎ½</button>
        
        <div id="result"></div>
        
        <h2>ğŸ“‹ Î›ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚</h2>
        <div class="info">
            <strong>Î¤Î¹ ÎºÎ¬Î½ÎµÎ¹ Î±Ï…Ï„ÏŒ Ï„Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿:</strong>
            <ul>
                <li>Î•Î¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ ÏŒÎ»Î± Ï„Î± reserve fund Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÏ„Î¿ localStorage</li>
                <li>ÎšÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ hardcoded Ï„Î¹Î¼Î­Ï‚ Ï€Î¿Ï… Ï€ÏÎ¿ÎºÎ±Î»Î¿ÏÎ½ Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î±</li>
                <li>Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î¿Î½ Î¿ÏÎ¹ÏƒÎ¼ÏŒ Î½Î­Ï‰Î½ Ï„Î¹Î¼ÏÎ½</li>
                <li>Î’Î¿Î·Î¸Î¬ ÏƒÏ„Î·Î½ ÎµÏ€Î¯Î»Ï…ÏƒÎ· Ï„Î¿Ï… Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î¿Ï‚ Î¼Îµ Ï„Î¿ Î±Ï€Î¿Î¸ÎµÎ¼Î±Ï„Î¹ÎºÏŒ</li>
            </ul>
        </div>
    </div>

    <script>
        function getStorageKey(buildingId, key) {
            return `reserve_fund_${buildingId}_${key}`;
        }
        
        function getAllReserveFundKeys() {
            const keys = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('reserve_fund_')) {
                    keys.push(key);
                }
            }
            return keys.sort();
        }
        
        function showCurrentState() {
            const keys = getAllReserveFundKeys();
            const currentStateDiv = document.getElementById('currentState');
            
            if (keys.length === 0) {
                currentStateDiv.innerHTML = '<div class="success">âœ… Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎ±Î½ reserve fund Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÏ„Î¿ localStorage</div>';
                return;
            }
            
            let html = '<h3>ğŸ” Î’ÏÎ­Î¸Î·ÎºÎ±Î½ Ï„Î± ÎµÎ¾Î®Ï‚ reserve fund Î´ÎµÎ´Î¿Î¼Î­Î½Î±:</h3>';
            html += '<pre>';
            
            keys.forEach(key => {
                try {
                    const value = localStorage.getItem(key);
                    const parsedValue = JSON.parse(value);
                    html += `${key}: ${JSON.stringify(parsedValue, null, 2)}\n`;
                } catch (e) {
                    html += `${key}: ${value}\n`;
                }
            });
            
            html += '</pre>';
            currentStateDiv.innerHTML = html;
        }
        
        function clearAllReserveFundData() {
            const keys = getAllReserveFundKeys();
            let clearedCount = 0;
            
            keys.forEach(key => {
                localStorage.removeItem(key);
                clearedCount++;
            });
            
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<div class="success">âœ… ÎšÎ±Î¸Î±ÏÎ¯ÏƒÏ„Î·ÎºÎ±Î½ ${clearedCount} reserve fund Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€ÏŒ Ï„Î¿ localStorage</div>`;
            
            showCurrentState();
        }
        
        function clearSpecificBuildingData() {
            const buildingId = '4'; // Î‘Î»ÎºÎ¼Î¬Î½Î¿Ï‚ 22
            const keys = ['goal', 'start_date', 'target_date', 'duration_months', 'monthly_target'];
            let clearedCount = 0;
            
            keys.forEach(key => {
                const storageKey = getStorageKey(buildingId, key);
                if (localStorage.getItem(storageKey)) {
                    localStorage.removeItem(storageKey);
                    clearedCount++;
                }
            });
            
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<div class="success">âœ… ÎšÎ±Î¸Î±ÏÎ¯ÏƒÏ„Î·ÎºÎ±Î½ ${clearedCount} Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î³Î¹Î± Ï„Î¿ ÎºÏ„Î¯ÏÎ¹Î¿ ${buildingId} (Î‘Î»ÎºÎ¼Î¬Î½Î¿Ï‚ 22)</div>`;
            
            showCurrentState();
        }
        
        function setDefaultValues() {
            const buildingId = '4'; // Î‘Î»ÎºÎ¼Î¬Î½Î¿Ï‚ 22
            
            // ÎŸÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï„Î¹Î¼ÏÎ½ Ï€Î¿Ï… Ï„Î±Î¹ÏÎ¹Î¬Î¶Î¿Ï…Î½ Î¼Îµ Ï„Î· Î²Î¬ÏƒÎ·
            const defaultData = {
                goal: 10000,
                start_date: '2024-01-01',
                target_date: '2025-12-31',
                duration_months: 24,
                monthly_target: 416.67
            };
            
            let setCount = 0;
            Object.entries(defaultData).forEach(([key, value]) => {
                const storageKey = getStorageKey(buildingId, key);
                localStorage.setItem(storageKey, JSON.stringify(value));
                setCount++;
            });
            
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<div class="success">âœ… ÎŸÏÎ¯ÏƒÏ„Î·ÎºÎ±Î½ ${setCount} Ï€ÏÎ¿ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î³Î¹Î± Ï„Î¿ ÎºÏ„Î¯ÏÎ¹Î¿ ${buildingId}</div>`;
            
            showCurrentState();
        }
        
        // Î¦ÏŒÏÏ„Ï‰ÏƒÎ· Î±ÏÏ‡Î¹ÎºÎ®Ï‚ ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚
        window.onload = function() {
            showCurrentState();
        };
    </script>
</body>
</html>
