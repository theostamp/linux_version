<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Building Selector Simple Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        pre { background: #f8f9fa; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>ğŸ¢ Building Selector Test</h1>
    
    <div class="test">
        <h3>1. Test API Connection</h3>
        <button onclick="testAPI()">Test API</button>
        <div id="api-result"></div>
    </div>

    <div class="test">
        <h3>2. Test Frontend Access</h3>
        <button onclick="testFrontend()">Test Frontend</button>
        <div id="frontend-result"></div>
    </div>

    <div class="test">
        <h3>3. Manual Building Selection Test</h3>
        <p>Î‘Î½Î¿Î¯Î¾Ï„Îµ Ï„Î¿ <a href="http://demo.localhost:8080/financial" target="_blank">Financial Dashboard</a> ÎºÎ±Î¹ Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÏ„Îµ Ï„Î¿Î½ building selector ÏƒÏ„Î¿ header.</p>
        <div id="manual-result">
            <p>ÎŸÎ´Î·Î³Î¯ÎµÏ‚:</p>
            <ol>
                <li>Î Î·Î³Î±Î¯Î½ÎµÏ„Îµ ÏƒÏ„Î¿ <a href="http://demo.localhost:8080/financial" target="_blank">Financial Dashboard</a></li>
                <li>ÎšÎ¬Î½Ï„Îµ login Î¼Îµ: theostam1966@gmail.com / admin123</li>
                <li>ÎšÎ¬Î½Ï„Îµ ÎºÎ»Î¹Îº ÏƒÏ„Î¿Î½ building selector ÏƒÏ„Î¿ header (Î´ÎµÎ¾Î¹Î¬ Î±Ï€ÏŒ Ï„Î¿ "ÎšÏ„Î¯ÏÎ¹Î¿:")</li>
                <li>Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏŒ ÎºÏ„Î¯ÏÎ¹Î¿</li>
                <li>Î•Î»Î­Î³Î¾Ï„Îµ Î±Î½ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Î»Î»Î¬Î¶Î¿Ï…Î½</li>
            </ol>
        </div>
    </div>

    <script>
        async function testAPI() {
            const resultDiv = document.getElementById('api-result');
            resultDiv.innerHTML = '<div class="info">Testing API...</div>';

            try {
                // First login
                const loginResponse = await fetch('http://demo.localhost:8000/api/users/login/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Host': 'demo.localhost'
                    },
                    body: JSON.stringify({
                        email: 'theostam1966@gmail.com',
                        password: 'admin123'
                    })
                });

                if (!loginResponse.ok) {
                    throw new Error(`Login failed: ${loginResponse.status}`);
                }

                const loginData = await loginResponse.json();
                const token = loginData.access;

                // Then get buildings
                const buildingsResponse = await fetch('http://demo.localhost:8000/api/buildings/', {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Host': 'demo.localhost'
                    }
                });

                if (!buildingsResponse.ok) {
                    throw new Error(`Buildings API failed: ${buildingsResponse.status}`);
                }

                const buildingsData = await buildingsResponse.json();
                
                resultDiv.innerHTML = `
                    <div class="success">
                        âœ… API Test Successful!<br>
                        Found ${buildingsData.count} buildings:<br>
                        <pre>${JSON.stringify(buildingsData.results, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        âŒ API Test Failed: ${error.message}
                    </div>
                `;
            }
        }

        async function testFrontend() {
            const resultDiv = document.getElementById('frontend-result');
            resultDiv.innerHTML = '<div class="info">Testing Frontend...</div>';

            try {
                const response = await fetch('http://demo.localhost:8080/financial', {
                    headers: {
                        'Host': 'demo.localhost'
                    }
                });

                if (response.ok) {
                    resultDiv.innerHTML = `
                        <div class="success">
                            âœ… Frontend Test Successful!<br>
                            Status: ${response.status}<br>
                            Content-Type: ${response.headers.get('content-type')}
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="error">
                            âŒ Frontend Test Failed: ${response.status} ${response.statusText}
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        âŒ Frontend Test Failed: ${error.message}
                    </div>
                `;
            }
        }

        // Auto-run tests
        window.onload = function() {
            console.log('ğŸ¢ Building Selector Test Page Loaded');
            testAPI();
            testFrontend();
        };
    </script>
</body>
</html> 